{
  "hash": "b110a9bb2dcaa710fde2850e56c22690",
  "result": {
    "markdown": "---\ntitle: \"Tracking training consistency, but making it pretty\"\ndate: \"2024-01-02\"\nimage: images/combined_plot.png\n\nbibliography: references.bib\ncategories:\n- R\n- Data analysis\n- Tutorial\n- Strava\n- Sports statistics\n\ndescription: 'Generating some ways to visualise training consistency.'\ngoogle-scholar: true\ncitation: true\n\nexecute: \n  warning: false\n---\n\n\nSo, my [last post](https://luke-ashton.netlify.app/posts/strava-api-analysis/) showed that I've done a pretty terrible job with the consistency of my aerobic activity since mid-2019. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(rStrava) \nlibrary(patchwork)\nlibrary(calendR)\nlibrary(sugrrants)\nlibrary(viridis)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstoken <- httr::config(\n  token = strava_oauth(\n    app_name, \n    client_id, \n    client_secret, \n    app_scope = \"activity:read_all\",\n    cache = TRUE)\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nactivity.list <- stoken %>%\n  get_activity_list() %>%\n  compile_activities() %>%\n  mutate(date = as_date(gsub(\"T.*\", \"\", start_date_local)),\n         day = day(start_date_local),\n         weekday = weekdays(as.POSIXct(start_date_local)),\n         week = isoweek(ymd_hms(start_date_local)),\n         month = month(as.POSIXct(start_date_local)),\n         year = year(as.POSIXct(start_date_local)))\n```\n:::\n\n\n# calendR - nice\n\n\n::: {.cell}\n\n```{.r .cell-code}\nworkout.days <- activity.list %>%\n  filter(year == 2024) %>%\n  select(day) %>%\n  pull()\n\n# The first problem is that this library can't handle more than one day entry! \n\ncalendR(year = 2024,\n        month = 1,\n        start = \"M\", \n        special.days = workout.days,\n        special.col = rev(c(ggokabeito::palette_okabe_ito())))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n# sugrrants\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nframe <- activity.list %>%\n  filter(year == 2018 & date > \"2018-03-31\") %>%\n  group_by(date) %>%\n  tally() %>%\n  complete(date = seq(date(\"2018-04-01\"), date(\"2018-12-31\"), by = \"1 day\"),\n           fill = list(n = 0)) %>%\n  frame_calendar(x = 1, y = 1, \n                 date = date, \n                 calendar = \"monthly\")\n\np1 <- frame %>%\n  \n  ggplot(aes(x = .x, y = .y)) +\n  geom_tile(aes(fill = as.factor(n)), colour = \"grey50\") +\n  # scale_fill_viridis_d() + \n  scale_fill_manual(values = c(\"grey\",\"#440154FF\",\"#3B528BFF\",\"#21908CFF\",\"#5DC863FF\",\"#FDE725FF\")) + \n  theme_minimal() +\n  labs(fill = \"No. of activities\") + \n  theme(\n    panel.grid = element_blank()\n  )\n\nprettify(p1, label = \"label\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n# My data in the new year!\n\n::: {.panel-tabset}\n\n## All activities\n\n\n::: {.cell}\n\n```{.r .cell-code}\nall <- activity.list %>%\n  filter(year == 2024 & manual != \"TRUE\") %>%\n  group_by(date) %>%\n  tally() %>%\n  complete(date = seq(date(\"2024-01-01\"), date(\"2024-01-31\"), by = \"1 day\"), \n           fill = list(n = 0)) %>%\n  frame_calendar(x = 1, y = 1, \n                 date = date, \n                 calendar = \"monthly\")\n\np.all <- all %>%\n  \n  ggplot(aes(x = .x, y = .y)) +\n  geom_tile(aes(fill = as.factor(n)), colour = \"grey50\") +\n  # scale_fill_viridis_d() + \n  scale_fill_manual(values = c(\"grey\",\"#440154FF\",\"#3B528BFF\",\"#21908CFF\",\"#5DC863FF\",\"#FDE725FF\")) + \n  theme_minimal() +\n  labs(fill = \"No. of Activities\") + \n  theme(\n    panel.grid = element_blank()\n  )\n\nprettify(p.all, label = \"label\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n## Running\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrun <- activity.list %>%\n  filter(year == 2024 & grepl(\"run\", tolower(sport_type))) %>%  \n  group_by(date) %>%\n  tally() %>%\n  complete(date = seq(date(\"2024-01-01\"), date(\"2024-01-31\"), by = \"1 day\"), \n           fill = list(n = 0)) %>%\n  frame_calendar(x = 1, y = 1, \n                 date = date, \n                 calendar = \"monthly\")\n\np.run <- run %>%\n  \n  ggplot(aes(x = .x, y = .y)) +\n  geom_tile(aes(fill = as.factor(n)), colour = \"grey50\") +\n  scale_fill_viridis_d() + \n  theme_minimal() +\n  labs(fill = \"No. of Runs\") + \n  theme(\n    panel.grid = element_blank()\n  )\n\nprettify(p.run, label = \"label\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n## Riding\n\n\n::: {.cell}\n\n```{.r .cell-code}\nride <- activity.list %>%\n  filter(year == 2024 & grepl(\"ride\", tolower(sport_type))) %>%  \n  group_by(date) %>%\n  tally() %>%\n  complete(date = seq(date(\"2024-01-01\"), date(\"2024-01-31\"), by = \"1 day\"), \n           fill = list(n = 0)) %>%\n  frame_calendar(x = 1, y = 1, \n                 date = date, \n                 calendar = \"monthly\")\n\np.ride <- ride %>%\n  \n  ggplot(aes(x = .x, y = .y)) +\n  geom_tile(aes(fill = as.factor(n)), colour = \"grey50\") +\n  scale_fill_manual(values = c(\"grey\",\"#0072B2\")) +\n  theme_minimal() +\n  theme(\n    panel.grid = element_blank(),\n    legend.position = \"none\"\n  )\n\nprettify(p.ride, label = \"label\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n## Yoga / Stretching\n\n\n::: {.cell}\n\n```{.r .cell-code}\nyoga <- activity.list %>%\n  filter(year == 2024 & grepl(\"yoga\", tolower(sport_type))) %>%  \n  group_by(date) %>%\n  tally() %>%\n  complete(date = seq(date(\"2024-01-01\"), date(\"2024-01-31\"), by = \"1 day\"), \n           fill = list(n = 0)) %>%\n  frame_calendar(x = 1, y = 1, \n                 date = date, \n                 calendar = \"monthly\")\n\np.yoga <- yoga %>%\n  \n  ggplot(aes(x = .x, y = .y)) +\n  geom_tile(aes(fill = as.factor(n)), colour = \"grey50\") +\n  scale_fill_manual(values = c(\"grey\",\"#0072B2\")) +\n  theme_minimal() +\n  theme(\n    panel.grid = element_blank(),\n    legend.position = \"none\"\n  )\n\nprettify(p.yoga, label = \"label\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n## Resistance training\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweights <- activity.list %>%\n  filter(year == 2024 & grepl(\"weight\", tolower(sport_type))) %>%  \n  group_by(date) %>%\n  tally() %>%\n  complete(date = seq(date(\"2024-01-01\"), date(\"2024-01-31\"), by = \"1 day\"), \n           fill = list(n = 0)) %>%\n  frame_calendar(x = 1, y = 1, \n                 date = date, \n                 calendar = \"monthly\")\n\np.weights <- weights %>%\n  \n  ggplot(aes(x = .x, y = .y)) +\n  geom_tile(aes(fill = as.factor(n)), colour = \"grey50\") +\n  scale_fill_manual(values = c(\"grey\",\"#0072B2\")) +\n  theme_minimal() +\n  theme(\n    panel.grid = element_blank(),\n    legend.position = \"none\"\n  )\n\nprettify(p.weights, label = \"label\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n## Swimming\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nswim <- activity.list %>%\n  filter(year == 2024 & grepl(\"swim\", tolower(sport_type))) %>%  \n  group_by(date) %>%\n  tally() %>%\n  complete(date = seq(date(\"2024-01-01\"), date(\"2024-01-31\"), by = \"1 day\"), \n           fill = list(n = 0)) %>%\n  frame_calendar(x = 1, y = 1, \n                 date = date, \n                 calendar = \"monthly\")\n\np.swim <- swim %>%\n  \n  ggplot(aes(x = .x, y = .y)) +\n  geom_tile(aes(fill = as.factor(n)), colour = \"grey50\") +\n  scale_fill_manual(values = c(\"grey\",\"#0072B2\")) +\n  theme_minimal() +\n  theme(\n    panel.grid = element_blank(),\n    legend.position = \"none\"\n  )\n\nprettify(p.swim, label = \"label\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n:::\n\n# Table of activities\n\n\n\n\n\n::: {.panel-tabset}\n\n## Weekly totals\n\n\n::: {.cell}\n\n```{.r .cell-code}\nactivity.mod %>%\n  rename(Week = week) %>%\n  group_by(Week) %>%\n  summarise(`Total time (hours)` = sum(elapsed_time) / 3600,\n            `Total distance (km)` = sum(distance),\n            `Total elevation (m)` = sum(total_elevation_gain))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Week\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Total time (hours)\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Total distance (km)\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Total elevation (m)\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"5.763611\",\"3\":\"50.6413\",\"4\":\"243.8\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## Monthly totals\n\n\n::: {.cell}\n\n```{.r .cell-code}\nactivity.mod %>%\n  rename(Month = month) %>%\n  group_by(Month) %>%\n  summarise(`Total time (hours)` = sum(elapsed_time) / 3600,\n            `Total distance (km)` = sum(distance),\n            `Total elevation (m)` = sum(total_elevation_gain))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Month\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Total time (hours)\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Total distance (km)\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Total elevation (m)\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"5.763611\",\"3\":\"50.6413\",\"4\":\"243.8\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## No. of activities\n\n\n::: {.cell}\n\n```{.r .cell-code}\nactivity.mod %>%\n  rename(\n    Week = week, \n    `Type of Activity` = sport_type\n  ) %>%\n  group_by(Week) %>%\n  count(`Type of Activity`) %>%\n  rename(Number = n)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Week\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Type of Activity\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Number\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"Ride\",\"3\":\"2\"},{\"1\":\"1\",\"2\":\"Run\",\"3\":\"1\"},{\"1\":\"1\",\"2\":\"Swim\",\"3\":\"1\"},{\"1\":\"1\",\"2\":\"Walk\",\"3\":\"2\"},{\"1\":\"1\",\"2\":\"WeightTraining\",\"3\":\"2\"},{\"1\":\"1\",\"2\":\"Yoga\",\"3\":\"3\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n:::\n\n# Goals\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrun_goals.week <- 3\nswim_goals.week <- 1\nride_goals.week <- 1.5\nstretch_goals.week <- 3\nresistance_goals.week <- 3\n\nrun_goals.year <- 150\nswim_goals.year <- 50\nride_goals.year <- 75\nstretch_goals.year <- 150\nresistance_goals.year <- 150\n```\n:::\n\n\n\n# Final piece of stupidity\n\nAlso, I present: **the Strava E-PB challenge!** \n\nFirst, some background for those unaware. Strava has a set of 'Estimated Best Efforts' on each runner's profile page for each distance they've completed - ranging from 400m to the 50km. These are linked to outdoor activities recorded with GPS, so 'Estimated Best Efforts' cannot be derived from indoor treadmill runs or manual activities. Also, it's important for my wellbeing, and likely the wellbeing of anyone dumb enough to try this, to note that one can only participate in the challenge during times when they are healthy (not-sick, stressed, or overworked) and uninjured (and yes, for the purposes of this challenge niggles count as injuries!). \n\nSo - starting with your 400m Estimated Best Effort (henceforth, Estimated Personal Best [E-PB]), attempt to set a new Strava-approved E-PB. If you achieve a new E-PB, then move to the next distance. To keep things interesting, you **must** attempt the next E-PB (in this instance, the 1/2 mile distance) within 2-4 weeks (at first glance, I reckon 2 weeks for anything less than a half-marathon and 3-4 weeks for distances at the HM or above) from setting your last E-PB. Note: it is possible to set two E-PBs in the same session (for instance, the 15km and 10 mile; or the 20km and half-marathon). However, you are under no obligation to attempt a new E-PB for at least two weeks after having just set one. \n\nIf you fail, then you have an allotted time to train and re-attempt. This depends on both the distance (longer runs being substantively more fatiguing); how far you were from a new E-PB (there's no point trying again soon if you're an hour off the marathon time :|); and how many times you have attempted setting a new E-PB at this distance. I don't want to come up with anything too formal, but perhaps the following provides some guidance. \n\nAfter failing, I recommend doubling the amount of time between this attempt and your last successful E-PB. If you do not feel you are close to setting a new E-PB after your first attempt, then consider doubling this amount of time again. For every failed attempt at an E-PB distance there is another doubling in the amount of time before you have to re-attempt it. Let's make all of that a little more concrete with two examples.\n\nExample 1: You attempt a new 5km E-PB and do not achieve it. You took 2 weeks between your 2 mile and the 5km, so you take 4 weeks before re-attempting. If you fail it again, then take 8 weeks, then 16, etc, etc.  \n\nExample 2: You attempt a new marathon E-PB and narrowly miss it. As this is a substantive distance and will have a large impact on the body, consider taking 8 weeks before your first re-attempt - ideally, you will have taken 3-4 before attempting it after setting a new 30km E-PB. If you miss the time again, take 16 weeks, then 32 weeks, etc. However, if you are feeling spritely 20 weeks into your 32-week block, then feel free to attempt it beforehand! This challenge is about pushing your limits. \n\nAppendix note: If you have a faulty GPS E-PB then consider deleting or flagging the suspect activity....alternatively, it's time to step up and break the 1-mile WR!",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}